//
//  IDPProgressView.m
//  IDP
//
//  Created by zhoubing on 14-2-13.
//
//

#import "MDFProgressView.h"

@implementation MDFProgressView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        [self commonInit];
    }
    return self;
}

- (void)awakeFromNib
{
    [self commonInit];
}

- (void)commonInit
{
    self.backgroundColor = [UIColor clearColor];
    self.indentation = 0.0f;
}

- (void)setIndentation:(CGFloat)indentation
{
    if (_indentation != indentation)
    {
        _indentation = indentation;
        [self.progressImageView setFrame:CGRectMake(self.indentation, 0.0f, (self.bounds.size.width - 2*self.indentation)*_progress, self.bounds.size.height)];
    }
}

- (void)setBackColor:(UIColor *)backColor
{
    if(backColor != _backColor)
    {
        self.backImageView = [[UIImageView alloc] initWithFrame:self.bounds];
        self.backImageView.backgroundColor = self.backColor;
        [self addSubview:self.backImageView];
        [self sendSubviewToBack:self.backImageView];
    }
}

- (void)setProgressColor:(UIColor *)progressColor
{
    if(progressColor != _progressColor)
    {
        self.progressImageView = [[UIImageView alloc] initWithFrame:CGRectMake(self.indentation, 0.0f, 0.0f, self.bounds.size.height)];
        self.progressImageView.backgroundColor = self.progressColor;
        [self addSubview:self.progressImageView];
    }
}

- (void)setBackImage:(UIImage *)backImage
{
    if(backImage != _backImage)
    {
        self.backImageView = [[UIImageView alloc] initWithFrame:self.bounds];
        self.backImageView.image = self.backImage;
        [self addSubview:self.backImageView];
        [self sendSubviewToBack:self.backImageView];
    }
}

- (void)setProgressImage:(UIImage *)progressImage
{
    if(progressImage != _progressImage)
    {
        self.progressImageView = [[UIImageView alloc] initWithFrame:CGRectMake(self.indentation, 0.0f, 0.0f, self.bounds.size.height)];
        self.progressImageView.image = self.progressImage;
        [self addSubview:self.progressImageView];
    }
}

- (void)setProgress:(CGFloat)progress
{
    [self setProgress:progress animated:NO];
}

- (void)setProgress:(CGFloat)progress animated:(BOOL)animated
{
    if (isnan(progress) || progress < 0.0f)
    {
        progress = 0.0f;
    }

    if (progress > 1.0f)
    {
        progress = 1.0f;
    }

    _progress = progress;

    if (animated)
    {
        [UIView animateWithDuration:0.25f animations:^{
            [self.progressImageView setFrame:CGRectMake(self.indentation, 0.0f, (self.bounds.size.width - 2*self.indentation)*progress, self.bounds.size.height)];
        }];
    }
    else
    {
        [self.progressImageView setFrame:CGRectMake(self.indentation, 0.0f, (self.bounds.size.width - 2*self.indentation)*progress, self.bounds.size.height)];
    }
}

- (CGFloat)progress
{
    return _progress;
}

//////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
@end
