//
//  MDFTextField.m
//  JDBClient
//
//  Created by You Tu on 15/1/20.
//  Copyright (c) 2015年 JDB. All rights reserved.
//

#import "MDFTextField.h"

@implementation MDFTextField

+ (MDFTextField *)clone:(MDFTextField *)textField
{
    MDFTextField *cloned = [[self alloc] init];
    cloned.backgroundColor = textField.backgroundColor;
    cloned.textColor = textField.textColor;
    cloned.font = textField.font;
    cloned.textAlignment = textField.textAlignment;
    cloned.disableAction = textField.disableAction;
    cloned.translatesAutoresizingMaskIntoConstraints = textField.translatesAutoresizingMaskIntoConstraints;
    return cloned;
}

// placeholder 的颜色改变
- (void)drawPlaceholderInRect:(CGRect)rect
{
    if (self.placeholderTextColor || self.placeholderFont) {
        if (self.placeholderTextColor) {
            [self.placeholderTextColor setFill];
        }

        NSMutableDictionary *attributes = [NSMutableDictionary dictionary];
        UIFont *font = self.placeholderFont ? self.placeholderFont : self.font;
        [attributes mdf_safeSetObject:font forKey:NSFontAttributeName];
        
        [attributes mdf_safeSetObject:self.placeholderTextColor forKey:NSForegroundColorAttributeName];
        
        NSMutableParagraphStyle *paragraphStyle = [[NSParagraphStyle defaultParagraphStyle] mutableCopy];
        paragraphStyle.lineBreakMode = NSLineBreakByClipping;
        paragraphStyle.alignment = self.textAlignment;
        [attributes mdf_safeSetObject:paragraphStyle forKey:NSParagraphStyleAttributeName];
        
        [self.placeholder drawInRect:rect withAttributes:attributes];
    } else {
        [super drawPlaceholderInRect:rect];
    }
}

// 定义可编辑的区域 （根据 textInsets 属性）
- (CGRect)editingRectForBounds:(CGRect)bounds
{
    if (UIEdgeInsetsEqualToEdgeInsets(UIEdgeInsetsZero, self.textInsets)) {
        return [super editingRectForBounds:bounds];
    }
    UIEdgeInsets i = self.textInsets;
    return CGRectMake(bounds.origin.x + i.left, bounds.origin.y + i.top,
                      bounds.size.width - i.left - i.right, bounds.size.height - i.top - i.bottom);
}

// 定义内容显示区域的大小 （根据 textInsets 属性）
- (CGRect)textRectForBounds:(CGRect)bounds
{
    if (UIEdgeInsetsEqualToEdgeInsets(UIEdgeInsetsZero, self.textInsets)) {
        return [super textRectForBounds:bounds];
    }
    UIEdgeInsets i = self.textInsets;
    return CGRectMake(bounds.origin.x + i.left, bounds.origin.y + i.top,
                      bounds.size.width - i.left - i.right, bounds.size.height - i.top - i.bottom);
}

- (BOOL)canPerformAction:(SEL)action withSender:(id)sender
{
    if (self.disableAction) {
        return NO;
    }
    return [super canPerformAction:action withSender:sender];
}

@end
